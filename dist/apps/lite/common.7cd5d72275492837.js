"use strict";(self.webpackChunklite=self.webpackChunklite||[]).push([[592],{8411:(h,l,e)=>{e.d(l,{k:()=>i});var d=e(7021),n=e(3900),c=e(2722),s=e(8505),u=e(6129),a=e(4004),g=e(262),p=e(4086),f=e(7579),m=e(515),M=e(5963),E=e(1640),A=e(9606),z=e(1743),b=e(7486),R=e(1721),S=e(6403),C=e(415),w=e(5e3);class i{constructor(t,o,r){this.apiService=t,this.webSocketService=o,this.store=r,this.destroy$=new f.x,this.connection$=o.isConnect()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}subscribe(t){this.connection$.pipe((0,n.w)(o=>o?this.wsAccess(t):this.httpAccess(t)),(0,c.R)(this.destroy$)).subscribe()}httpAccess(t){return"devices"===t.api?this.updateDevices(t):"locations"===t.api?this.updateLocations(t):m.E}wsAccess(t){var o,r;return null!==(r=null===(o=i.wsAccessMap.get(t.api))||void 0===o?void 0:o(this))&&void 0!==r?r:m.E}subscribeDevices(){return this.webSocketService.on("me.z-wave.devices",()=>({event:"httpEncapsulatedRequest",data:{url:i.baseApiUrl+i.apiList.devices,method:"GET"},responseEvent:"me.z-wave.devices"})).pipe((0,c.R)(this.destroy$),(0,s.b)(t=>{this.store.dispatch(t instanceof Object?"structureChanged"in t?new E.HS(t.devices,t.structureChanged):new E.HS([t]):new E.aL(t))}))}subscribeLocations(){return this.webSocketService.on("me.z-wave.locations",()=>({event:"httpEncapsulatedRequest",data:{url:i.baseApiUrl+i.apiList.locations,method:"GET"},responseEvent:"me.z-wave.locations"})).pipe((0,c.R)(this.destroy$),(0,s.b)(t=>this.store.dispatch(new z.ae(t))))}updateDevices({api:t,timeBetweenRequests:o}){let r;return(0,M.H)(0,null!=o?o:3e3).pipe((0,u.z)(()=>this.apiService.send(t,r)),(0,a.U)(({updateTime:y,structureChanged:D,devices:T})=>{this.store.dispatch(new E.HS(T,!r)),r=D?void 0:{params:{since:y}},console.groupEnd()}),(0,g.K)((y,D)=>(console.log("updateDevices",JSON.stringify(y)),D.pipe((0,p.g)(1e3)))))}updateLocations({api:t,timeBetweenRequests:o}){return(0,M.H)(0,null!=o?o:6e3).pipe((0,u.z)(()=>this.apiService.send(t)),(0,a.U)(r=>{this.store.dispatch(new z.ae(r))}),(0,g.K)((r,y)=>(console.log("updateLocations",JSON.stringify(r)),y.pipe((0,p.g)(1e3)))))}subscribeProfile(){return this.webSocketService.on("me.z-wave.profile",()=>({event:"httpEncapsulatedRequest",data:{url:i.baseApiUrl+i.apiList.profiles,method:"GET"},responseEvent:"me.z-wave.profile"})).pipe((0,c.R)(this.destroy$),(0,s.b)(t=>[t].flat().map(o=>this.store.dispatch(new R.Bc(S.k.profileAdapter(o))))))}subscribeNotifications(){return this.webSocketService.on("me.z-wave.notifications").pipe((0,c.R)(this.destroy$),(0,s.b)(t=>{this.store.dispatch(new C.l(t))}))}}i.apiList={backup:"backup",customicon:"devices",devices:"devices",factory_default:"resetToFactoryDefault",firmwareupdate:"system/webif-access",firstaccess:"system/first-access",hide_devices:"hidedevices",icons:"icons",icons_install:"icons/install",icons_upload:"icons/upload",instances:"instances",ip_address:"system/ip-address",locations:"locations",locations_image:"locations/image",login:"login",logout:"logout",modules:"modules",modules_categories:"modules/categories",modules_transform:"modules/transform",namespaces:"namespaces",notification_channels:"notificationChannels",notification_filtering:"notificationFiltering",notifications:"notifications",oauth2:"oauth2",online_delete:"modules/delete",online_install:"modules/install",online_reset:"modules/reset",online_update:"modules/update",password_reset:"auth/forgotten",ping:"system/time/get",profiles:"profiles",profiles_auth_update:"auth/update",remote_id:"system/remote-id",reorder:"devices/reorder",restore:"restore",session:"session",skins:"skins",skins_active:"skins/active",skins_install:"skins/install",skins_reset:"skins/setToDefault",skins_update:"skins/update",system_info:"system/info",system_reboot:"system/reboot",time:"system/time/get",time_zone:"system/timezone",tokens:"modules/tokens",trust_my_network:"system/trust-my-network",update_device_database:"system/zwave/deviceInfoUpdate",update_zwave_vendors:"system/zwave/vendorsInfoUpdate",wifi_cli:"system/wifiCli/settings",wifi_cli_connection_type:"system/connectionType",zwave_devices:"system/zwave/deviceInfoGet",zwave_vendors:"system/zwave/vendorsInfoGet"},i.baseApiUrl="/ZAutomation/api/v1/",i.wsAccessMap=new Map([["profile",v=>v.subscribeProfile()],["locations",v=>v.subscribeLocations()],["devices",v=>v.subscribeDevices()],["notifications",v=>v.subscribeNotifications()]]),i.\u0275fac=function(t){return new(t||i)(w.LFG(d.s),w.LFG(b.i),w.LFG(A.yh))},i.\u0275prov=w.Yz7({token:i,factory:i.\u0275fac,providedIn:"any"})},2178:(h,l,e)=>{e.d(l,{M:()=>u});var d=e(9606);const n={admin:[1],admin_user:[1],apps:[1],appsLocal:[1],appsOnline:[1],customize:[1],module:[1],devices:[1,2,3],myAccess:[1,2,3],expertView:[1],remoteAccess:[1],devicesInclude:[1],rooms:[1,2,3,4],addRoom:[1],element:[1,2,3,4],eventDelete:[1],configRooms:[1],configRoomsId:[1],network:[1,3],networkConfigId:[1],logout:[1,2,3,4],automation:[1]};var c=e(6403),s=e(5e3);let u=(()=>{class a{constructor(p,f,m){this.templateRef=p,this.viewContainer=f,this.store=m}set zWaveSecure(p){const f=this.store.selectSnapshot(c.k.profile).role;n[p].find(m=>m===f)?this.viewContainer.createEmbeddedView(this.templateRef):this.viewContainer.clear()}}return a.\u0275fac=function(p){return new(p||a)(s.Y36(s.Rgc),s.Y36(s.s_b),s.Y36(d.yh))},a.\u0275dir=s.lG2({type:a,selectors:[["","zWaveSecure",""]],inputs:{zWaveSecure:"zWaveSecure"}}),a})()},4189:(h,l,e)=>{e.d(l,{$:()=>c});var d=e(9808),n=e(5e3);let c=(()=>{class s{}return s.\u0275fac=function(a){return new(a||s)},s.\u0275mod=n.oAB({type:s}),s.\u0275inj=n.cJS({imports:[[d.ez]]}),s})()},5351:(h,l,e)=>{e.d(l,{$:()=>n});const n=new(e(5e3).OlP)("ServerStreamService Token")},2004:(h,l,e)=>{e.d(l,{T:()=>c});var d=e(9808),n=e(5e3);let c=(()=>{class s{}return s.\u0275fac=function(a){return new(a||s)},s.\u0275mod=n.oAB({type:s}),s.\u0275inj=n.cJS({imports:[[d.ez]]}),s})()},8062:(h,l,e)=>{e.d(l,{_:()=>c});var d=e(9808),n=e(5e3);let c=(()=>{class s{}return s.\u0275fac=function(a){return new(a||s)},s.\u0275mod=n.oAB({type:s}),s.\u0275inj=n.cJS({imports:[[d.ez]]}),s})()}}]);